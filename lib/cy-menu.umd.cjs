(function(O,w){typeof exports=="object"&&typeof module<"u"?w(exports):typeof define=="function"&&define.amd?define(["exports"],w):(O=typeof globalThis<"u"?globalThis:O||self,w(O.CyMenu={}))})(this,function(O){"use strict";const w={};function we(e){w.context=e}const xe=(e,t)=>e===t,Ae=Symbol("solid-track"),U={equals:xe};let se=oe;const L=1,q=2,ie={owned:null,cleanups:null,context:null,owner:null};var v=null;let M=null,g=null,m=null,P=null,V=0;function F(e,t){const n=g,s=v,l=e.length===0,o=l?ie:{owned:null,cleanups:null,context:null,owner:t||s},c=l?e:()=>e(()=>I(()=>X(o)));v=o,g=null;try{return j(c,!0)}finally{g=n,v=s}}function y(e,t){t=t?Object.assign({},U,t):U;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=l=>(typeof l=="function"&&(l=l(n.value)),re(n,l));return[le.bind(n),s]}function T(e,t,n){const s=Q(e,t,!1,L);R(s)}function Ee(e,t,n){se=Be;const s=Q(e,t,!1,L);s.user=!0,P?P.push(s):R(s)}function k(e,t,n){n=n?Object.assign({},U,n):U;const s=Q(e,t,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,R(s),le.bind(s)}function I(e){const t=g;g=null;try{return e()}finally{g=t}}function Se(e){Ee(()=>I(e))}function Ce(e){return v===null||(v.cleanups===null?v.cleanups=[e]:v.cleanups.push(e)),e}function $e(e,t){const n=Symbol("context");return{id:n,Provider:Me(n),defaultValue:e}}function _e(e){let t;return(t=ae(v,e.id))!==void 0?t:e.defaultValue}function Pe(e){const t=k(e),n=k(()=>D(t()));return n.toArray=()=>{const s=n();return Array.isArray(s)?s:s!=null?[s]:[]},n}function le(){const e=M;if(this.sources&&(this.state||e))if(this.state===L||e)R(this);else{const t=m;m=null,j(()=>G(this),!1),m=t}if(g){const t=this.observers?this.observers.length:0;g.sources?(g.sources.push(this),g.sourceSlots.push(t)):(g.sources=[this],g.sourceSlots=[t]),this.observers?(this.observers.push(g),this.observerSlots.push(g.sources.length-1)):(this.observers=[g],this.observerSlots=[g.sources.length-1])}return this.value}function re(e,t,n){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&j(()=>{for(let l=0;l<e.observers.length;l+=1){const o=e.observers[l],c=M&&M.running;c&&M.disposed.has(o),(c&&!o.tState||!c&&!o.state)&&(o.pure?m.push(o):P.push(o),o.observers&&ce(o)),c||(o.state=L)}if(m.length>1e6)throw m=[],new Error},!1)),t}function R(e){if(!e.fn)return;X(e);const t=v,n=g,s=V;g=v=e,Le(e,e.value,s),g=n,v=t}function Le(e,t,n){let s;try{s=e.fn(t)}catch(l){e.pure&&(e.state=L),ue(l)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?re(e,s):e.value=s,e.updatedAt=n)}function Q(e,t,n,s=L,l){const o={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:v,context:null,pure:n};return v===null||v!==ie&&(v.owned?v.owned.push(o):v.owned=[o]),o}function W(e){const t=M;if(e.state===0||t)return;if(e.state===q||t)return G(e);if(e.suspense&&I(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<V);)(e.state||t)&&n.push(e);for(let s=n.length-1;s>=0;s--)if(e=n[s],e.state===L||t)R(e);else if(e.state===q||t){const l=m;m=null,j(()=>G(e,n[0]),!1),m=l}}function j(e,t){if(m)return e();let n=!1;t||(m=[]),P?n=!0:P=[],V++;try{const s=e();return Te(n),s}catch(s){m||(P=null),ue(s)}}function Te(e){if(m&&(oe(m),m=null),e)return;const t=P;P=null,t.length&&j(()=>se(t),!1)}function oe(e){for(let t=0;t<e.length;t++)W(e[t])}function Be(e){let t,n=0;for(t=0;t<e.length;t++){const s=e[t];s.user?e[n++]=s:W(s)}for(w.context&&we(),t=0;t<n;t++)W(e[t])}function G(e,t){const n=M;e.state=0;for(let s=0;s<e.sources.length;s+=1){const l=e.sources[s];l.sources&&(l.state===L||n?l!==t&&W(l):(l.state===q||n)&&G(l,t))}}function ce(e){const t=M;for(let n=0;n<e.observers.length;n+=1){const s=e.observers[n];(!s.state||t)&&(s.state=q,s.pure?m.push(s):P.push(s),s.observers&&ce(s))}}function X(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),s=e.sourceSlots.pop(),l=n.observers;if(l&&l.length){const o=l.pop(),c=n.observerSlots.pop();s<l.length&&(o.sourceSlots[c]=s,l[s]=o,n.observerSlots[s]=c)}}if(e.owned){for(t=0;t<e.owned.length;t++)X(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function Ne(e){return e instanceof Error||typeof e=="string"?e:new Error("Unknown error")}function ue(e){throw e=Ne(e),e}function ae(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:ae(e.owner,t):void 0}function D(e){if(typeof e=="function"&&!e.length)return D(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const s=D(e[n]);Array.isArray(s)?t.push.apply(t,s):t.push(s)}return t}return e}function Me(e,t){return function(s){let l;return T(()=>l=I(()=>(v.context={[e]:s.value},Pe(()=>s.children))),void 0),l}}const Ie=Symbol("fallback");function fe(e){for(let t=0;t<e.length;t++)e[t]()}function Oe(e,t,n={}){let s=[],l=[],o=[],c=0,r=t.length>1?[]:null;return Ce(()=>fe(o)),()=>{let d=e()||[],a,i;return d[Ae],I(()=>{let u=d.length,h,p,b,E,$,x,A,S,N;if(u===0)c!==0&&(fe(o),o=[],s=[],l=[],c=0,r&&(r=[])),n.fallback&&(s=[Ie],l[0]=F(ee=>(o[0]=ee,n.fallback())),c=1);else if(c===0){for(l=new Array(u),i=0;i<u;i++)s[i]=d[i],l[i]=F(f);c=u}else{for(b=new Array(u),E=new Array(u),r&&($=new Array(u)),x=0,A=Math.min(c,u);x<A&&s[x]===d[x];x++);for(A=c-1,S=u-1;A>=x&&S>=x&&s[A]===d[S];A--,S--)b[S]=l[A],E[S]=o[A],r&&($[S]=r[A]);for(h=new Map,p=new Array(S+1),i=S;i>=x;i--)N=d[i],a=h.get(N),p[i]=a===void 0?-1:a,h.set(N,i);for(a=x;a<=A;a++)N=s[a],i=h.get(N),i!==void 0&&i!==-1?(b[i]=l[a],E[i]=o[a],r&&($[i]=r[a]),i=p[i],h.set(N,i)):o[a]();for(i=x;i<u;i++)i in b?(l[i]=b[i],o[i]=E[i],r&&(r[i]=$[i],r[i](i))):l[i]=F(f);l=l.slice(0,c=u),s=d.slice(0)}return l});function f(u){if(o[i]=u,r){const[h,p]=y(i);return r[i]=p,t(d[i],h)}return t(d[i])}}}function B(e,t){return I(()=>e(t||{}))}function He(e){const t="fallback"in e&&{fallback:()=>e.fallback};return k(Oe(()=>e.each,e.children,t||void 0))}function ke(e,t,n){let s=n.length,l=t.length,o=s,c=0,r=0,d=t[l-1].nextSibling,a=null;for(;c<l||r<o;){if(t[c]===n[r]){c++,r++;continue}for(;t[l-1]===n[o-1];)l--,o--;if(l===c){const i=o<s?r?n[r-1].nextSibling:n[o-r]:d;for(;r<o;)e.insertBefore(n[r++],i)}else if(o===r)for(;c<l;)(!a||!a.has(t[c]))&&t[c].remove(),c++;else if(t[c]===n[o-1]&&n[r]===t[l-1]){const i=t[--l].nextSibling;e.insertBefore(n[r++],t[c++].nextSibling),e.insertBefore(n[--o],i),t[l]=n[o]}else{if(!a){a=new Map;let f=r;for(;f<o;)a.set(n[f],f++)}const i=a.get(t[c]);if(i!=null)if(r<i&&i<o){let f=c,u=1,h;for(;++f<l&&f<o&&!((h=a.get(t[f]))==null||h!==i+u);)u++;if(u>i-r){const p=t[c];for(;r<i;)e.insertBefore(n[r++],p)}else e.replaceChild(n[r++],t[c++])}else c++;else t[c++].remove()}}}const de="_$DX_DELEGATE";function Re(e,t,n,s={}){let l;return F(o=>{l=o,t===document?e():C(t,e(),t.firstChild?null:void 0,n)},s.owner),()=>{l(),t.textContent=""}}function K(e,t,n){const s=document.createElement("template");s.innerHTML=e;let l=s.content.firstChild;return n&&(l=l.firstChild),l}function je(e,t=window.document){const n=t[de]||(t[de]=new Set);for(let s=0,l=e.length;s<l;s++){const o=e[s];n.has(o)||(n.add(o),t.addEventListener(o,Ue))}}function Ke(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function J(e,t){t==null?e.removeAttribute("class"):e.className=t}function he(e,t,n){return I(()=>e(t,n))}function C(e,t,n,s){if(n!==void 0&&!s&&(s=[]),typeof t!="function")return Y(e,t,s,n);T(l=>Y(e,t(),l,n),s)}function Ue(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}}),w.registry&&!w.done&&(w.done=!0,document.querySelectorAll("[id^=pl-]").forEach(s=>s.remove()));n!==null;){const s=n[t];if(s&&!n.disabled){const l=n[`${t}Data`];if(l!==void 0?s.call(n,l,e):s.call(n,e),e.cancelBubble)return}n=n.host&&n.host!==n&&n.host instanceof Node?n.host:n.parentNode}}function Y(e,t,n,s,l){for(w.context&&!n&&(n=[...e.childNodes]);typeof n=="function";)n=n();if(t===n)return n;const o=typeof t,c=s!==void 0;if(e=c&&n[0]&&n[0].parentNode||e,o==="string"||o==="number"){if(w.context)return n;if(o==="number"&&(t=t.toString()),c){let r=n[0];r&&r.nodeType===3?r.data=t:r=document.createTextNode(t),n=H(e,n,s,r)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||o==="boolean"){if(w.context)return n;n=H(e,n,s)}else{if(o==="function")return T(()=>{let r=t();for(;typeof r=="function";)r=r();n=Y(e,r,n,s)}),()=>n;if(Array.isArray(t)){const r=[],d=n&&Array.isArray(n);if(Z(r,t,n,l))return T(()=>n=Y(e,r,n,s,!0)),()=>n;if(w.context){if(!r.length)return n;for(let a=0;a<r.length;a++)if(r[a].parentNode)return n=r}if(r.length===0){if(n=H(e,n,s),c)return n}else d?n.length===0?pe(e,r,s):ke(e,n,r):(n&&H(e),pe(e,r));n=r}else if(t instanceof Node){if(w.context&&t.parentNode)return n=c?[t]:t;if(Array.isArray(n)){if(c)return n=H(e,n,s,t);H(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Z(e,t,n,s){let l=!1;for(let o=0,c=t.length;o<c;o++){let r=t[o],d=n&&n[o];if(r instanceof Node)e.push(r);else if(!(r==null||r===!0||r===!1))if(Array.isArray(r))l=Z(e,r,d)||l;else if(typeof r=="function")if(s){for(;typeof r=="function";)r=r();l=Z(e,Array.isArray(r)?r:[r],Array.isArray(d)?d:[d])||l}else e.push(r),l=!0;else{const a=String(r);d&&d.nodeType===3&&d.data===a?e.push(d):e.push(document.createTextNode(a))}}return l}function pe(e,t,n=null){for(let s=0,l=t.length;s<l;s++)e.insertBefore(t[s],n)}function H(e,t,n,s){if(n===void 0)return e.textContent="";const l=s||document.createTextNode("");if(t.length){let o=!1;for(let c=t.length-1;c>=0;c--){const r=t[c];if(l!==r){const d=r.parentNode===e;!o&&!c?d?e.replaceChild(l,r):e.insertBefore(l,n):d&&r.remove()}else o=!0}}else e.insertBefore(l,n);return[l]}const qe=e=>!!(e&&e.nodeName&&e.nodeType===1),Fe=e=>qe(e)?e:typeof e=="string"?document.querySelector(e):document.createElement("div"),ge=e=>{if(e instanceof Function)return e;{const t=document.createElement("div");return()=>t}},z=(e=[],t=0,n="children")=>{const s=[];return!e||e.length<1?[]:(e.forEach(l=>{const o=Object.assign(l,{level:t});l[n]&&(o[n]=z(l[n],t+1)),s.push(o)}),s)},ve=$e();function We(e){const[t,n]=y(e.slots.headerSlot||null),[s,l]=y(e.slots.footerSlot||null),[o,c]=y(e.props.footerHeight||"0"),[r,d]=y({}),[a,i]=y(e.props.expand||!0),[f,u]=y(e.props.data||[]),[h,p]=y(e.props.labelProp||"label"),[b,E]=y(e.props.keyProp||"key"),[$,x]=y(e.props.childProp||"children"),[A,S]=y(e.props.openKeys||[]),[N,ee]=y(e.props.height||"100%"),[nt,st]=y(e.props.width||"240px");u(()=>[...z(f(),0,$())]);const te={headerSlot:{value:t,change:n},footerSlot:{value:s,change:l},footerHeight:{value:o,change:c},scrollInstance:{value:r,change:d},expand:{value:a,change:_=>i(_===!0||_===!1?_:!a)},data:{value:f,change:_=>{const ne=z(_);u(()=>[...ne])}},labelProp:{value:h,change:p},keyProp:{value:b,change:E},childProp:{value:$,change:x},openKeys:{value:A,change:S},height:{value:N,change:ee},width:{value:nt,change:st}};return Object.keys(te).forEach(_=>{const ne=_.slice(0,1).toLocaleUpperCase()+_.slice(1);e.methods[`update${ne}`]=te[_].change}),B(ve.Provider,{value:te,get children(){return e.children}})}function me(){return _e(ve)}const Ge=K('<div class="cy-menu-item-popover"></div>'),Ye=e=>{let t=null;const n=12,[s,l]=y(!1),[o,c]=y({stopClose:!1,x:0,y:0,gap:n}),r=d=>{if(e.disabled)return;const{right:a,top:i}=d.target.getBoundingClientRect(),f={x:a,y:i,stopClose:!0,gap:o().gap};if(c(()=>({...f})),!t)return;const u=t.offsetHeight+i-window.screen.height;if(u>0){const p=i-u<0;c(()=>({...o(),y:p?0:i-u,gap:p?n+i:n+u}))}else c(()=>({...o(),gap:n}))};return e.ref({updatePopover:l,setMouseEvent:r}),(()=>{const d=Ge.cloneNode(!0),a=t;return typeof a=="function"?he(a,d):t=d,C(d,(()=>{const i=k(()=>!!s());return()=>i()?k(()=>e.name):[]})()),T(i=>{const f=ye(o().x),u=ye(o().y);return f!==i._v$&&d.style.setProperty("--cy-menu-x",i._v$=f),u!==i._v$2&&d.style.setProperty("--cy-menu-y",i._v$2=u),i},{_v$:void 0,_v$2:void 0}),d})()},ye=e=>typeof e!="number"?e:`${e}px`,Ve=K('<li class="cy-menu-item"><div class="cy-menu-item-box"><div class="cy-menu-item-label"></div></div></li>'),Qe=K("<div></div>"),Xe=e=>{const{openKeys:t,keyProp:n,labelProp:s,childProp:l,scrollInstance:o}=me(),c=e.data.children&&e.data.children.length>0?e.data.children:null;let r=null;const d=i=>{if(!c)return;const f=i[n.value()],u=t.value(),h=u.findIndex(p=>p===f);h>-1?u.splice(h,1):u.push(f),t.change(()=>[...u]),h>-1&&o.value().hiddenBar()},a=(i,f)=>{!r||(r.updatePopover(i),r.setMouseEvent(f))};return(()=>{const i=Ve.cloneNode(!0),f=i.firstChild,u=f.firstChild;return i.addEventListener("mouseleave",h=>a(!1,h)),i.addEventListener("mouseenter",h=>a(!0,h)),f.$$click=()=>d(e.data),C(u,()=>e.data[s.value()]),C(i,c?(()=>{const h=Qe.cloneNode(!0);return C(h,B(be,{get list(){return e.data[l.value()]},get level(){return e.level+1}})),T(()=>J(h,`cy-menu-item-child-list ${t.value().includes(e.data[n.value()])?"cy-menu-item-child-list-open":""}`)),h})():null,null),C(i,B(Ye,{ref(h){const p=r;typeof p=="function"?p(h):r=h},get name(){return e.data[s.value()]}}),null),i})()};je(["click"]);const De=K("<ul></ul>"),be=e=>(()=>{const t=De.cloneNode(!0);return C(t,B(He,{get each(){return e.list},children:n=>B(Xe,{data:n,get level(){return e.level}})})),T(n=>{const s=`cy-menu-list ${e.isContent?"cy-menu-content-list":""}`,l=e.level;return s!==n._v$&&J(t,n._v$=s),l!==n._v$2&&Ke(t,"data-level",n._v$2=l),n},{_v$:void 0,_v$2:void 0}),t})();function Je(e=window,t=document){var n=e.requestAnimationFrame||e.setImmediate||function(i){return setTimeout(i,0)};function s(i){const f=new a(i);return Object.defineProperty(i,"data-simple-scrollbar",{value:f,configurable:!0}),f}function l(i){!Object.prototype.hasOwnProperty.call(i,"data-simple-scrollbar")||(i["data-simple-scrollbar"].unBind(),delete i["data-simple-scrollbar"])}function o(i,f){var u;i.addEventListener("mousedown",function(b){return u=b.pageY,i.classList.add("cy-menu-grabbed"),t.body.classList.add("cy-menu-grabbed"),t.addEventListener("mousemove",h),t.addEventListener("mouseup",p),!1});function h(b){var E=b.pageY-u;u=b.pageY,n(function(){f.el.scrollTop+=E/f.scrollRatio})}function p(){i.classList.remove("cy-menu-grabbed"),t.body.classList.remove("cy-menu-grabbed"),t.removeEventListener("mousemove",h),t.removeEventListener("mouseup",p)}}function c(i){for(this.target=i,this.content=i.firstElementChild,this.direction=e.getComputedStyle(this.target).direction,this.bar='<div class="cy-menu-scroll">',this.mB=this.moveBar.bind(this),this.wrapper=t.createElement("div"),this.wrapper.setAttribute("class","cy-menu-wrapper"),this.el=t.createElement("div"),this.el.setAttribute("class","cy-menu-content"),this.direction==="rtl"&&this.el.classList.add("rtl"),this.wrapper.appendChild(this.el);this.target.firstChild;)this.el.appendChild(this.target.firstChild);this.target.appendChild(this.wrapper),this.target.insertAdjacentHTML("beforeend",this.bar),this.bar=this.target.lastChild,o(this.bar,this),this.moveBar(),e.addEventListener("resize",this.mB),this.el.addEventListener("scroll",this.mB),this.el.addEventListener("mouseenter",this.mB),this.target.classList.add("cy-menu-container");var f=e.getComputedStyle(i);f.height==="0px"&&f["max-height"]!=="0px"&&(i.style.height=f["max-height"]),this.unBind=function(){e.removeEventListener("resize",this.mB),this.el.removeEventListener("scroll",this.mB),this.el.removeEventListener("mouseenter",this.mB),this.target.classList.remove("cy-menu-container"),this.target.insertBefore(this.content,this.wrapper),this.target.removeChild(this.wrapper),this.target.removeChild(this.bar),this.bar=null}}c.prototype={moveBar:function(){var i=this.el.scrollHeight,f=this.el.clientHeight,u=this;this.scrollRatio=f/i;var h=u.direction==="rtl",p=h?u.target.clientWidth-u.bar.clientWidth+18:(u.target.clientWidth-u.bar.clientWidth)*-1;n(function(){u.scrollRatio>=1?u.bar.classList.add("cy-menu-hidden"):(u.bar.classList.remove("cy-menu-hidden"),u.bar.style.cssText="height:"+Math.max(u.scrollRatio*100,10)+"%; top:"+u.el.scrollTop/i*100+"%;right:"+p+"px;")})},hiddenBar:function(){var i=this;i.bar.classList.add("cy-menu-hidden")}};function r(){for(var i=t.querySelectorAll("*[cy-menu-container]"),f=0;f<i.length;f++)s(i[f])}function d(){for(var i=t.querySelectorAll(".cy-menu-container"),f=0;f<i.length;f++)l(i[f])}t.addEventListener("DOMContentLoaded",r),c.initEl=s,c.initAll=r,c.unbindEl=l,c.unbindAll=d;var a=c;return a}const it="",Ze=K('<div><div class="cy-menu-header"></div><div class="cy-menu-footer"></div></div>'),ze=()=>{const{headerSlot:e,footerSlot:t,expand:n,data:s,height:l,width:o,footerHeight:c,scrollInstance:r}=me();let d={};return Se(()=>{const i=Je().initEl(d);r.change(()=>i)}),(()=>{const a=Ze.cloneNode(!0),i=a.firstChild,f=i.nextSibling,u=d;return typeof u=="function"?he(u,a):d=a,C(i,()=>ge(e.value())("header")),C(a,B(be,{isContent:!0,get list(){return s.value()},level:0}),f),C(f,()=>ge(t.value())("footer")),T(h=>{const p=`cy-menu ${n.value()?"cy-menu-expand":"cy-menu-shrink"}`,b=l.value(),E=o.value(),$=c.value();return p!==h._v$&&J(a,h._v$=p),b!==h._v$2&&a.style.setProperty("--cy-menu-height",h._v$2=b),E!==h._v$3&&a.style.setProperty("--cy-menu-width",h._v$3=E),$!==h._v$4&&a.style.setProperty("--cy-menu-footer-height",h._v$4=$),h},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),a})()},lt="",et=(e,t,n)=>B(We,{props:e,slots:t,methods:n,get children(){return B(ze,{})}}),tt=(e,t,n)=>{const s={},l=Re(()=>et(t,n,s),Fe(e));return s.disposer=l,s};O.renderApp=tt,Object.defineProperties(O,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
